<style>
    .twoColumns {
        display: flex;
    }

    .showList div:nth-child(2) {
        display: none;
    }

    .showDetails div:nth-child(1) {
        display: none;
    }
</style>
<mat-sidenav-container autosize>
    <mat-sidenav #sidemenu
        [opened]="sideMenuOpened"
        [mode]="mobileQuery.matches ? 'over' : 'side'"
        [fixedInViewport]="mobileQuery.matches"
        fixedTopGap="0"
        id="sideMenu"
        style="width: 330px"
    >
        <app-sidenav-menu (closeMenu)="sideMenu.close()"></app-sidenav-menu>
        <mat-nav-list dense>
            <mat-list-item>
                <button mat-button routerLink="/contacts/new">
                    <mat-icon> person_add </mat-icon> New contact
                </button>
            </mat-list-item>
            <mat-list-item>
                <button mat-button routerLink="/contacts/new_group" (click)="shownGroup = null">
                    <mat-icon> group_add </mat-icon> New group
                </button>
            </mat-list-item>
            <mat-list-item>
                <input #vcfUploadInput type="file" [hidden]="true" multiple (change)="onVcfUploaded($event)" />
                <button mat-button (click)="importVcfClicked()">
                    <mat-icon>import_export</mat-icon> Import contacts
                </button>
            </mat-list-item>
            <mat-list-item>
                <a mat-button routerLink="/contacts/settings">
                    <mat-icon> settings </mat-icon> Settings
                </a>
            </mat-list-item>

            <mat-divider></mat-divider>

            <mat-list-item>
                <a mat-button routerLink="/contacts/" matTooltip="Show all contacts">
                    <mat-icon> group </mat-icon>
                    <span [ngClass]="!shownGroup ? 'selectedGroupLabel' : ''">
                        Show all contacts
                    </span>
                </a>
            </mat-list-item>

            <mat-list-item *ngFor="let group of groups" (drop)="dropContactTo(group, $event)">
                <a mat-button routerLink="/contacts/{{ group.id }}" matTooltip="View details">
                    <span [ngClass]="(shownGroup ? shownGroup.id : null) === group.id ? 'selectedGroupLabel' : ''">
                        <app-contact-button [contact]="group"></app-contact-button>
                    </span>
                </a>
            </mat-list-item>
        </mat-nav-list>

        <div class="multiContactActions" *ngIf="selectedCount > 0">
            <button mat-fab *ngIf="groups.length > 0"
                matTooltip="Add these contacts to a group"
                (click)="addSelectedToGroup()"
            >
                <mat-icon [matBadge]="selectedCount" matBadgePosition="below before"> group_add </mat-icon>
            </button>

            <button mat-fab
                matTooltip="Delete these contacts"
                (click)="deleteSelected()"
            >
                <mat-icon [matBadge]="selectedCount" matBadgePosition="below before"> delete </mat-icon>
            </button>
        </div>
    </mat-sidenav>
    <mat-sidenav-content>
        <mat-toolbar *ngIf="mobileQuery.matches" style="display: flex; justify-content: space-between;">
            <button mat-icon-button (click)="sidemenu.toggle()">
                <mat-icon>menu</mat-icon>
            </button>

            <span *ngIf="!showingDetails">
                <span *ngIf="shownGroup; else showingAll">
                    Showing group <button mat-stroked-button (click)="showDetails(true)"> {{ shownGroup.display_name() }} </button>
                </span>
                <ng-template #showingAll>
                    Showing all contacts
                </ng-template>
            </span>

            <button mat-icon-button *ngIf="showingDetails" (click)="closeDetails()">
                <mat-icon> close </mat-icon>
            </button>
        </mat-toolbar>
        <div [class]="appLayout">
            <div class="contactList">
                <mat-nav-list dense>
                    <app-contact-list #contactList
                        [contacts]="shownContacts"
                        [categories]="categories"
                        [allowDragging]="true"
                        [showDragHelpers]="contactsservice.settings.showDragHelpers"
                        (selectionUpdated)="onContactsSelected($event)"
                    ></app-contact-list>

                    <mat-list-item *ngIf="contactsservice.migratingContacts > 0">
                        <a routerLink="/contacts/settings"> {{ contactsservice.migratingContacts }} contact(s) not migrated yet </a>
                    </mat-list-item>
                </mat-nav-list>
            </div>
            <div class="contactDetails">
                <router-outlet></router-outlet>
            </div>
        </div>
    </mat-sidenav-content>
</mat-sidenav-container>
